# Telegram 計算機鎖定應用程式

這是一個具有隱私保護功能的 Telegram 桌面應用程式，使用計算機介面作為鎖定畫面，提供完整的隱私保護和緊急資料清除功能。

## 功能特色

- **計算機鎖定畫面**：應用程式啟動時顯示功能完整的計算機
- **密碼解鎖**：通過在計算機上輸入特定數字序列來解鎖應用程式
- **緊急清除功能**：快速清除所有登入資料和會話記錄
- **自動鎖定**：閒置一段時間後自動返回鎖定畫面
- **密碼管理**：可自訂解鎖密碼和閒置時間
- **macOS 原生通知支援**
- **完整的 Telegram Web 功能**

## 安裝與啟動

### 1. 安裝依賴套件

```bash
npm install
```

### 2. 啟動應用程式

```bash
npm start
```

### 3. 建置 DMG 安裝檔（macOS）

```bash
npm run build-dmg
```

## 基本操作

### 首次使用

1. 啟動應用程式後會看到計算機畫面
2. 預設解鎖密碼為：**1209**
3. 在計算機上依序輸入 1、2、0、9（可使用鍵盤或點擊按鈕）
4. 成功解鎖後會顯示 Telegram Web 介面

### 解鎖應用程式

在計算機畫面上輸入您的解鎖密碼（預設：1209）即可解鎖。

**提示**：
- 可以使用滑鼠點擊計算機按鈕
- 也可以直接使用鍵盤數字鍵輸入
- 密碼會在背景自動檢測，不需要按等號或確認鍵

### 鎖定應用程式

在 Telegram 介面中，從選單列選擇：**Telegram** > **鎖定應用程式**

### 計算機快捷鍵

在計算機畫面可使用以下鍵盤快捷鍵：

- **數字鍵 0-9**：輸入數字
- **+ - * /**：運算符號
- **Enter 或 =**：計算結果
- **Backspace**：清除當前輸入（C）
- **Escape**：全部清除（AC）
- **.（小數點）**：輸入小數

## 緊急清除功能（重要）

應用程式提供兩種緊急清除資料的方式：

### 方式一：計算機畫面清除

在**計算機鎖定畫面**上輸入：**4444**

效果：
- 清除所有 Telegram 登入資料
- 清除應用程式快取
- 重置密碼為預設值（1209）
- 顯示「資料已清除，密碼已重置為預設值」訊息

### 方式二：Telegram 介面緊急清除

在**已解鎖的 Telegram 介面**中，快速按鍵盤 **"4"** 六次（444444）

觸發條件：
- 必須在 3 秒內連續按 6 次 "4"
- 只能按 "4"，按其他鍵會重置計數

效果：
- 立即清除所有 Telegram 會話資料（localStorage、sessionStorage、IndexedDB）
- 清除應用程式快取
- 重置密碼為預設值（1209）
- 自動返回計算機鎖定畫面

**使用情境**：當您需要緊急隱藏 Telegram 或清除使用記錄時使用。

## 進階設定

### 自訂密碼和設定

從選單列選擇：**Telegram** > **設定**

在設定面板中可以：

1. **更改解鎖密碼**
   - 輸入新密碼（只能包含數字）
   - 點擊「儲存密碼」
   - 密碼會立即生效

2. **設定自動鎖定時間**
   - 輸入閒置秒數（例如：300 = 5 分鐘）
   - 點擊「儲存設定」
   - 超過設定時間沒有操作會自動鎖定

3. **重置為預設密碼**
   - 點擊「重置為預設密碼」按鈕
   - 密碼將重置為 1209

### 自動鎖定

應用程式會監測使用者活動：
- 預設閒置時間：5 分鐘（300 秒）
- 可在設定中自訂閒置時間
- 超過設定時間沒有鍵盤或滑鼠活動會自動鎖定
- 鎖定後需要輸入密碼才能繼續使用

## 專案結構

```
tg_mac_electron/
├── main.js                 # 主程序，應用程式進入點
├── preload.js              # 預載腳本，提供安全的 API 橋接
├── calculator-lock.html    # 計算機鎖定畫面
├── settings.html           # 設定面板
├── panic-detector.js       # 緊急模式偵測器（注入到 Telegram 頁面）
├── package.json            # 專案設定和相依套件
└── icon.png               # 應用程式圖示
```

## 運作原理

1. **啟動**：應用程式啟動時顯示 `calculator-lock.html`
2. **BrowserView**：Telegram Web 載入在背景的 BrowserView 中（位於畫面外）
3. **解鎖**：輸入正確密碼後，BrowserView 移動到可見位置
4. **鎖定**：鎖定時 BrowserView 移動到畫面外（y: -10000），顯示計算機畫面
5. **緊急模式**：偵測特定按鍵序列，觸發資料清除並返回計算機畫面

## 資料儲存

- 密碼儲存在：`~/Library/Application Support/telegram-calculator/config.json`
- Telegram 資料儲存在：`~/Library/Application Support/telegram-calculator/telegram-data/`
- 緊急清除會刪除以上所有資料

## 常見問題

### Q: 忘記密碼怎麼辦？

A: 有兩種方式：

1. 在計算機畫面輸入 `4444` 清除資料並重置為預設密碼 1209
2. 手動刪除設定檔：
   ```bash
   rm ~/Library/Application\ Support/telegram-calculator/config.json
   ```
   然後重新啟動應用程式

### Q: 如何完全移除應用程式？

A:

1. 刪除應用程式：將 Telegram.app 移到垃圾桶
2. 刪除資料檔案：
   ```bash
   rm -rf ~/Library/Application\ Support/telegram-calculator/
   ```

### Q: 緊急清除會刪除哪些資料？

A:
- 所有 Telegram 登入會話
- 聊天記錄快取
- 應用程式設定（密碼會重置為 1209）
- 所有儲存在應用程式目錄的檔案

執行緊急清除後需要重新登入 Telegram。

### Q: 為什麼選擇計算機作為鎖定畫面？

A: 計算機外觀具有偽裝效果，不容易引起注意。同時也是功能完整的計算機，可以正常使用。

## 系統需求

- macOS 10.13 或更高版本
- Node.js 14 或更高版本
- Electron 最新版

## 開發資訊

### 除錯

應用程式會在主控台輸出詳細的除錯訊息，使用 `npm start` 啟動時可以查看。

關鍵除錯訊息標籤：
- `[Main]`：主程序訊息
- `[Preload]`：預載腳本訊息
- `[Calculator]`：計算機畫面訊息
- `[Panic Detector]`：緊急模式偵測器訊息

## 版本歷史

### v2.0 (目前版本)

- 修復計算機狀態重置錯誤
- 移除未使用的檔案（calculator.html, test-notification.html 等）
- 簡化為純 BrowserView 架構
- 新增完整的操作文件

### v1.0 (初始版本)

- 實作 BrowserView 架構
- 計算機鎖定畫面
- 密碼保護和緊急清除功能
- 自動鎖定機制

## 授權

本專案為內部使用專案。

## 聯絡資訊

如有問題或建議，請聯絡開發團隊。
